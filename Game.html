<!DOCTYPE html>
<html lang="en">
<head>
    <title>Snake and Ladder Game</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
    <h1>Snake and Ladder Game</h1>
    <div id="board" class="board"></div>
    <div class="button_div"><button class="button" onclick="rollDice()">Roll Dice</button></div>
    <div class="play_status" id="play_id"></div>

    <script>
        const BOARD_SIZE = 10;
        let SNAKES = new Map();
        let LADDERS = new Map();
        let VALUES = [];
        let INDEXES = [];

        let position = 0;

        function prepare_snakes()
        {
            for (let i = 0; i < 10; i++)
            {
                let start = Math.floor(Math.random() * 99) + 1;
                let end = Math.floor(Math.random() * (start - 1)) + 1;
                if (start > end)
                {
                    SNAKES[start] = end;
                }
                else
                {
                    i--;
                }
            }
        }

        function prepare_ladder()
        {
            for (let i = 0; i < 10; i++)
            {
                let start = Math.floor(Math.random() * 99) + 1;
                let end = Math.floor(Math.random() * (99 - start)) + start;
                if (start < end)
                {
                    LADDERS[start] = end;
                }
                else
                {
                    i--;
                }
            }
        }

        function remove_conflicting_snake_and_ladder()
        {
            for (let i = 1; i <= 100; i++)
            {
                if (i in SNAKES && i in LADDERS)
                {
                    if (SNAKES[i] > LADDERS[i])
                    {
                        delete SNAKES[i];
                    }
                    else
                    {
                        delete LADDERS[i];
                    }
                }
            }
        }

        function fill_value_to_index()
        {
            let index = 0;
            for (let i = BOARD_SIZE - 1; i >= 0; i--)
            {
                if (i % 2 == 0)
                {
                    for (let j = 0; j < BOARD_SIZE; j++)
                    {
                        VALUES[index] = i * BOARD_SIZE + j + 1;
                        INDEXES[VALUES[index]] = index;
                        index++;
                    }
                }
                else
                {
                    for (let j = BOARD_SIZE - 1; j >= 0; j--)
                    {
                        VALUES[index] = i * BOARD_SIZE + j + 1;
                        INDEXES[VALUES[index]] = index;
                        index++;
                    }
                }
            }

        }

        function isLadder(p)
        {
            if (p in LADDERS)
            {
                return true
            }
            return false;
        }

        function isSnake(p)
        {
            if (p in SNAKES)
            {
                return true
            }
            return false;
        }

        function drawBoard()
        {
            const boardElement = document.getElementById("board");
            boardElement.innerHTML = "";
            let board_number;

            for (let i = 0; i < BOARD_SIZE * BOARD_SIZE; i++)
            {
                board_number = VALUES[i];
                const gridItem = document.createElement("div");
                if (isLadder(board_number))
                {
                    gridItem.classList.add("cell_ladder");
                }
                if (isSnake(board_number))
                {
                    gridItem.classList.add("cell_snake");
                }
                gridItem.classList.add("cell");
                gridItem.textContent = board_number;
                document.body.querySelector(".board").appendChild(gridItem);
            }
        }

        function movePlayer(steps)
        {
            const playStatus = document.getElementById("play_id");
            playStatus.innerHTML = "Player rolled: " + steps;
            let oldposition = position;
            position += steps;
            if (position in SNAKES)
            {
                playStatus.innerHTML += "</Br>Snake Bites!";
                position = SNAKES[position];
            }
            else if (position in LADDERS)
            {
                playStatus.innerHTML += "</Br>Climbed Ladder!";
                position = LADDERS[position];
            }

            if (position == BOARD_SIZE * BOARD_SIZE)
            {
                playStatus.innerHTML = "You WON!";
                return;
            }
            updatePlayerindex(oldposition);
        }

        function updatePlayerindex(oldposition)
        {
            const cells = document.getElementsByClassName("cell");
            for (let cell of cells)
            {
                cell.classList.remove("active");
            }
            cells[INDEXES[position]].classList.add("active");

            const playStatus = document.getElementById("play_id");
            playStatus.innerHTML = "Player moved from " + oldposition + " to " + position;
        }

        function rollDice()
        {
            const playStatus = document.getElementById("play_id");
            if (position == BOARD_SIZE * BOARD_SIZE)
            {
                playStatus.innerHTML = "Game Over!";
                return;
            }
            const diceResult = Math.floor(Math.random() * 6) + 1;
            movePlayer(diceResult);
        }

        function init()
        {
            fill_value_to_index();
            prepare_snakes();
            prepare_ladder();
            remove_conflicting_snake_and_ladder();
            console.log(VALUES);
            console.log(INDEXES);
            console.log(SNAKES);
            console.log(LADDERS);
            drawBoard();
        }
        init();
    </script>
    <style>
        .play_status
        {
            font-size: 20px;
            font-weight: bold;
            margin-top: 20px;
        }

        .button_div
        {
            margin-top: 20px;
            text-align: center;
        }

        .button
        {
            align-items: center;
            display: inline-block;
            padding: 12px 24px;
            font-size: 18px;
            font-weight: bold;
            text-align: center;
            text-decoration: none;
            border-radius: 6px;
            color: #ffffff;
            background-color: #4CAF50;
            border: none;
            transition: background-color 0.3s ease;
            cursor: pointer;
        }

        .button:hover
        {
            background-color: #45a049;
        }

        .button:active
        {
            background-color: #3e8e41;
        }

        .board
        {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            grid-template-rows: repeat(10, 1fr);
            width: 420px;
            height: 420px;
        }
        
        .cell
        {
            background-color: #f2f2f2;
            border: 1px solid #ccc;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 20px;
            font-weight: lighter;
            color: #333;
        }

        @keyframes blink
        {
            0% { opacity: 1; }
            50% { opacity: 0; }
            100% { opacity: 1; }
        }
        .active
        {
            background-color: #f2f2f2;
            border: 1px solid #ccc;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 20px;
            font-weight: lighter;
            color: #333;
            animation: blink 1s infinite;
        }
        .cell_ladder
        {
            background-color: #90EE90;
            border: 1px solid #ccc;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 20px;
            font-weight: lighter;
            color: #333;
        }
        .cell_snake
        {
            background-color: #FFC0CB;
            border: 1px solid #ccc;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 20px;
            font-weight: lighter;
            color: #333;
        }
    </style>
</body>
</html>
